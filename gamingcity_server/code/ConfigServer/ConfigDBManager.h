#pragma once

#include "LuaDBConnectionPool.h"
#include "Singleton.h"
#include "common_msg_define.pb.h"

/**********************************************************************************************//**
 * \class	DBManager
 *
 * \brief	Manager for databases.
 **************************************************************************************************/

class ConfigDBManager : public TSingleton<ConfigDBManager>
{
public:

	/**********************************************************************************************//**
	 * \brief	Default constructor.
	 **************************************************************************************************/

	ConfigDBManager();

	/**********************************************************************************************//**
	 * \brief	Destructor.
	 **************************************************************************************************/

	virtual ~ConfigDBManager();

	/**********************************************************************************************//**
	 * \brief	开启数据库线程并运行.
	 **************************************************************************************************/

	void run();

	/**********************************************************************************************//**
	 * \brief	等待线程结束.
	 **************************************************************************************************/

	void join();

	/**********************************************************************************************//**
	 * \brief	请求关闭.
	 **************************************************************************************************/

	void stop();

	/**********************************************************************************************//**
	 * \brief	每一帧调用.
	 **************************************************************************************************/

	virtual void tick();

	/**********************************************************************************************//**
	 * \brief	得到config数据库.
	 *
	 * \return	The database connection game.
	 **************************************************************************************************/

	LuaDBConnectionPool& get_db_connection_config() { return db_connection_config_; }

protected:
	LuaDBConnectionPool							db_connection_config_;
};
